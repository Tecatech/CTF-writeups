The bug is uninitialized stack variables and a buffer overflow in the encode function. Using the uninit bug, we can get a stack leak. Given the stack leak, we can uniquely determine the random memory for qemu, and break aslr. To exploit, jump to our stack buffer for shellcode execution. Shellcode reads in a second stage non-null shellcode, which will mount rootfs.img, find the flag, then puts the flag.

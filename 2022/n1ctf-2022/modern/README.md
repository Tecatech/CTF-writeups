The binary implements a stack-based VM in C++. The bug is in race condition on different threads on std::vector through push\_back and pop\_back. With this, we can read and write relative to the vector heap buffer. Starting new threads leave a mmap ptr on the heap which we can leak. With libc leak, we can walk to tcache\_perthread\_struct and modify freelist head to allocate the vector buffer over IO\_stdout. Then, we use FSOP to RCE.

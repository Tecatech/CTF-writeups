from output import *
from tqdm import tqdm
from Crypto.Util.number import *
import random

a = 143684642197375144177147158855853692668588800554193977558610296778751822580114038001358324581787378580872562099321966717548328915955931557014819660248335768703843650181118037332168940615255654385428471399452134131237486655430385594698984041709528412818098878208671854494888289862816247508570341341144291061804686340591902597677708742601740239151407141330097096057960696869868306378165361528290787726188133329061186703067302036544465101778190513113434324043654457
b = 167352289538521831900068303893849462884611879177327891332587809720230639559806397413772956644716449447590735981383896960276712495542059479149006336979727641959120139405218127535689160497885057304889947873643276371840497731671102379214228403473852990097216100053584104183830792848580118046966013781807107306470368639380702010022756255560693596301723230682190906560616366646290287284412622207608529405928696609593713613820866492056395760168172577692798799704251087
n = 591703505189598943502532470020819444351417786427559744959290752225569789666099653318864844640178933068932025277859268335616211431452288797227920690077916934058390749961256662320969850344143774517775954191622800337672863912047782627

NN = Zmod(n^2)

def add1(P, Q):
    x1, y1, z1 = P
    x2, y2, z2 = Q

    s1 = (x1 * y2 - x2 * y1) * (y1 * z2 + y2 * z1) + (x1 * z2 - x2 * z1) * y1 * y2
    s1 += -a * (x1 * z2 - x2 * z1) * (x1 * z2 + x2 * z1) - 3 * b * (x1 * z2 - x2 * z1) * z1 * z2
    s2 = -3 * x1 * x2 * (x1 * y2 - x2 * y1) - y1 * y2 * (y1 * z2 - y2 * z1)
    s2 += -a * (x1 * y2 - x2 * y1) * z1 * z2 + a * (y1 * z2 - y2 * z1) * (x1 * z2 + x2 * z1)
    s2 += 3 * b * (y1 * z2 - y2 * z1) * z1 * z2
    s3 = 3 * x1 * x2 * (x1 * z2 - x2 * z1) - (y1 * z2 - y2 * z1) * (y1 * z2 + y2 * z1)
    s3 += a * (x1 * z2 - x2 * z1) * z1 * z2

    assert s2^2 * s3 - s1^3 - a*s1*s3^2 - b*s3^3 == 0

    return [s1, s2, s3]

def add2(P, Q):
    x1, y1, z1 = P
    x2, y2, z2 = Q

    t1 = y1 * y2 * (x1 * y2 + x2 * y1) - a * x1 * x2 * (y1 * z2 + y2 * z1)
    t1 += -a * (x1 * y2 + x2 * y1) * (x1 * z2 + x2 * z1) - 3 * b * (x1 * y2 + x2 * y1) * z1 * z2
    t1 += -3 * b * (x1 * z2 + x2 * z1) * (y1 * z2 + y2 * z1) + a^2 * (y1 * z2 + y2 * z1) * z1 * z2
    t2 = y1^2 * y2^2 + 3 * a * x1^2 * x2^2 + 9 * b * x1 * x2 * (x1 * z2 + x2 * z1)
    t2 += -a^2 * x1 * z2 * (x1 * z2 + 2 * x2 * z1) - a^2 * x2 * z1 * (2 * x1 * z2 + x2 * z1)
    t2 += -3 * a * b * z1 * z2 * (x1 * z2 + x2 * z1) - (a^3 + 9 * b^2) * z1^2 * z2^2
    t3 = 3 * x1 * x2 * (x1 * y2 + x2 * y1) + y1 * y2 * (y1 * z2 + y2 * z1)
    t3 += a * (x1 * y2 + x2 * y1) * z1 * z2 + a * (x1 * z2 + x2 * z1) * (y1 * z2 + y2 * z1)
    t3 += 3 * b * (y1 * z2 + y2 * z1) * z1 * z2

    assert t2^2 * t3 - t1^3 - a*t1*t3^2 - b*t3^3 == 0

    return [t1, t2, t3]

def add(P, Q):
    x1, y1, z1 = add1(P, Q)
    x2, y2, z2 = add2(P, Q)
    return [(x1 + x2), (y1 + y2), (z1 + z2)]

def mult(k, P):
    if k == 0:
        return (0, 1, 0)
    elif k == 1:
        return P
    
    t = mult(k//2, P)
    t = add(t, t)
    if k % 2 == 1:
        t = add(t, P)
    return t

def map_to(P):
    x, y = P.xy()
    P_ = [x, y, NN(1)]
    inf = mult(gift, P_)
    r = int(inf[0] / inf[1])
    assert r % n == 0
    return P.change_ring(Zmod(n)), r // n

E = EllipticCurve(Zmod(n^2), [a, b])

P = E(chimera[0][0], chimera[0][1])
P, k = map_to(P)

# factors = [
#     2^6, 5, 7, 29, 2293, 2512087, 8617237, 17423449, 33433493,
#     1748422074881, 1796117487809,
#     # 1631225483257540300223, 18846862859317446527731,
#     # 1801464615405169705673437, 106930721636941554915513372671,
#     # 16938429955403036647865554190162687822881178267320778953870878644892708517
# ]

p = 26547499809981069510927003971948749075772722276992950364790653461858011919123580155558634725311902476358658974061571
gift_p = 26547499809981069510927003971948749075772722276992950364792314618117852191809368252259393907545335096600102525321072
factors_p = [
    #2^4,
    33433493, # 1796117487809 
]
assert n % p == 0

q = n // p
gift_q = 22288483263012814591348765846880205017828692034537673547054108766305150848936155217127280012115743233530006890953060
factors_q = [
    # 2^2, 5, 7,
    29, 2293, 2512087, 8617237, 17423449, # 1748422074881
]

# coefs = []

# for i in tqdm(range(1, 64)):
#     Q = E(chimera[i][0], chimera[i][1])
#     Q, l = map_to(Q)

#     to_crt = [[int(Zmod(n)(l) / Zmod(n)(k))], [n]]

#     for ppow in factors_p:
#         Pk = (gift_p // ppow) * P.change_ring(Zmod(p))
#         Qk = (gift_p // ppow) * Q.change_ring(Zmod(p))
#         dl = discrete_log(Qk, Pk, ppow, operation='+')

#         to_crt[0].append(dl)
#         to_crt[1].append(ppow)
    
#     for ppow in factors_q:
#         Pk = (gift_q // ppow) * P.change_ring(Zmod(q))
#         Qk = (gift_q // ppow) * Q.change_ring(Zmod(q))
#         dl = discrete_log(Qk, Pk, ppow, operation='+')

#         to_crt[0].append(dl)
#         to_crt[1].append(ppow)
    
#     coef = crt(to_crt[0], to_crt[1])
#     coefs.append(coef)

# print(coefs)
# exit(0)

# coefs = [
#     430798418785359758788870995701117504523041462936043076686581976991067878493983775873570850988674225107025547550063188427296496914845294009120865668366820679997478473676943382654818565164419226066631962513033248216841883039742296285703801529703002352545167786125899, 
#     151039011313881670798166580812236381610412836294654968744815891035849986887443594519052380841954155380843567596393119889227764003631984964279192058668318360839523091063507746968270501027278809492965066506767997091629315406034095621439204163624802340504949104777634, 
#     54022715069320635192207542174787520779715491668973955401130091588762909174770284370503470336758922816452409377653575943610253572184989381534904379598033871948746868950734942550175134563001221278514218994175395591883765257731424308290913254593247718745310513305059, 
#     132574000537493687294102919376320208109657863221126263240466402729740346752817067255648422897133352681428132877735506653530975781807603385879278360394093589031354509253595487640579649245715645679848966418815390601077736140225050733664515186850149319592080538295030, 
#     476103252351784595134971670172133206400245262355503531980574838668505502761679551656500029479742237443495801940070366520404568713711810402180041212099330171229463441583009114351957108790698962802003007208160249234974875644102347284062454796976326063709022845055799, 
#     481821972417327558806494180758843712663971081005562664338434467569701516330700666108308901275207836369007604403965078006606867122270557736218017889295081802178482636086514800680784279133132964942884903023238360848886967624082865223697373306825421229915094398068777, 
#     436281541014870482104022631053380598450346976221621003460050463735341544112560462069279731431068173747587972582018630841128208836836057532094085917015048887345599967088416338896498698304053668407902792366353976115903904013012081651904807293188436138018258011070003, 
#     347551287071530601204737859663994577776656293100880703478275056830132244558110421045676979938293821005593561132001973422798902851685031901917274158541914252701349020163463852605947393149566074465808337064738339205895796954959056430093079042368125567137770276796509, 
#     43397811807101934874013279332527262204048700743776720343767194151131435655063693348065413810329584872881122448692246044000655714508787015476161451265780216074303767982074458337395671162024933688147971623992448419263868542797756782192835278895771521870740837527571, 
#     159018937898625981786697344904052439055768893024783728192933616732780287344131407144661808012467782885945697462938977215765563452318458133664272011830887331138157919035307800683945326710018355610756575802543819771390605268556274515459704396394343098913940413602563, 
#     204450098428407576722037687143930762338382196070164323610487794076942139062820311721481053243282774407234939620325205957534335346036099935572861968557092042508713329847863274560217521294527419219863985009107099932847716292848522077378009926918126081243777218539983, 
#     277937982835450269206419504512026576281057022445344245117756311457167846670408968232981505385920858657433547468955599763746568768362453746122119300388877251888741966439043755892300840804728333279553317779773979298414813493930717110271664252595926559825155159934107, 
#     141920124975686128510870425638346919377543654849627661075282470356401690089089967718961258821730760125230809411944822665478070893181387053932560974474196037117567872104477621818547887756438746438159400322811305234203546776283985941180209463320008154107743880315745, 
#     417076255812219591850871279236295996656401906849644607664606105324630486714282045953094001559309420848507258587020752547180238679016300793816736036217537296956118568054933736404478958941830186766917459888476943191799399981249661033189894040265326152244631800420657, 
#     473254406498367391422578734520603009237793233075455788974291910026846528854978222025852217912240182068742854616306183395792521934711147045420346060395365702194675895751243555856701357337600942315919629415025390138295968448905579106076516554086313320186317684360036, 
#     290820275107037871596451907681276416890875488823114657540981535799296904245738891728104244483252124703943824408726846350783527436498273124382112912626545090310792980259626789388131207931032003238070542433743011360232372360919795854155002877235971153754389828166638, 
#     317452002696417158091600331222841974285797257359271007326725438642675228189961554025744349684655837391310099570649456441790227738257155242259268376490194605491864848565962280146512499066857103307104115353844148844216429073517602244911063596880949960683027136092329, 
#     433631746661560815240353980371844566460947829290686580183630910015298818512333751236273444406238945747653903220042365250563872827055316959011566228007022265147645045229918683095114443363225725608248938781342464287027283352139874601420848530037115104442627256558828, 
#     439094291601909430581230122980780299125878964051188687186756337831703576772778463473142783683044058432690528850501930883292817993578220167444410833694723308318018588510576239293631733503117369049357538519580209770219077060119174199644770215927878619170991676974403, 
#     494349344914549861411972874384199011646770468489740997157142214566823290915484702976882435453195357699676453040366229334615374457370291339310959184977063707008242975942872030602612507613335923303206610887360023278195255892844375125013143332203650234913454913390227, 
#     149072768737856324660207322404044360579595285701219544653256259843851584926265862207109422181517418124183167517815445074207837309914387319074076169751071888436239091861649626068433148337858175491473756186181082200752804798248467156104510854239923035538532645558730, 
#     94678005386567777816317810564222362288272115804367920034652614496670890448331366892862546821333539543964234514518638808470214274460747929829381844382081221463081164292535908885902063577428537430637917744447717729051880694919727583053271609729303935541911695116126, 
#     407576125098895444704296332257079036634528809728757564860706071427559649725487299658099713820314398175018507292157820701452957308902532792748474483134407492968173167764995482339621900567587567429766336669426225172807758722947158161867385129501049425743395329367848, 
#     289904761006160687628423433390592636531595616215347046189159705436534920316997269893235701902826784105773872416243718502565531862382019963466046675819178088806267191848433061124847778503675819432578221919338967803830908840966272252441842233122004704422125351122292, 
#     434513544317589526154199086459593923252252602000205539400946886532610317101086492439542383759197628787865904708361043452906465352426536192214773020353272239881594149148382024084736235772606634847104624937990047702612016869793219454313570663436889564748988409495805, 
#     432975895034889634782510820980780816897380980874483243108682028391185963070753568268316023927709694638667620716249045693267180381702988014004254889215653663375734217852327216986079377699882236703439235231160074987934250339082501151353023257364965310692158138264038, 
#     490091972646740551546374877979525113661411521784161011197936925506668499602408596362529320806885256818170490362588798828359334405715826480983983967016241637112908859740224343298856719372908904071096116394587292781427616077323033414349549082946350104932904401117196, 
#     164311811883889144319957208736023807557890804754938960256744374680110661986667088742224615719685969838976243740063656879388132861764068056715839605341151955273798323886634356463425118252357707349157944341060514548151575062589690952738152901868188368371194039281545, 
#     32283941509143680155765736233510348177465651595877437978911222572111470242534298703889705854320088629183416851066211835575364999824346146204338474962742007366258612473627209991741307859172647917517076860265646038745053219431551841602886239134728520077023486305970, 
#     100721760645597339561020516075406396888324333114121708368433806635961779713895188691690308734761548476666770839804177218780544230290952790530820213437065516576546837564016683047741894122945489367517613156925571020696808801306510350221645885462786169828287298485476, 
#     114031720116588920791447472168434040412984156776401486178138441794252258294735793967389796814586455986451939683813296441986070602675427227307589068553897058341668112082586945951341053312752340158465494108261092761183647882734381538466558262591083581747379760590625, 
#     111256519917930793231374496960424197844482260489903668778801946578564850414703377400436848531878498552402671017361936513864064138859268397680485902771206517514871083096716628869674110624574915948746268585896693098047988169333120078616375724199008245675016272754720, 
#     423499790155891861413543086054735112824972650022439116687942762265271741241178567371245132505239109042923999802127802561081290568428771461037303130142050911117593665379321699882875964235927811365603254124279913298593004862087265489947537404285142278241304518816911, 
#     255313642771988984003766522392177590580894268700803121147875509484387600832223338765511510029486875802833901338562597834398438023209527113719570018349878209721121173915061369544862957632591224491702884651116117480226451209737320488648125457131527303143966925603815, 
#     483355054375204952753538706955588312531264774110770664591776049086765688470644870087358777051099231341785601201279080811879016105459141493835415220662635709067429853643161365781205814985446987931761977038875227731569399873481269962768677803178853955029028122171980, 
#     329231273557172183254372175542401657983839674790594816260484899383668423610858633672934269375597592461776859592831060956676697185218233921765777937982056526700971093477061291832179728132176849220149133247361769428417209898537572777857048762946535743941113975643305, 
#     262783515926118473007234940873401205004759676675584492215490299288415888759790900615861949135016401291557782298491600432532609003023314980104793096974199436900391157673482969375225189665455406834020862806375386083666817310695942461612790679757212326714933295751706, 
#     123368240106445830510211030572765364371248349919617895243396654669492873811506104766847173267496029122166142504544202619776207431664837998915736231673628819346790836108282043920466681403687315116174672136777333428081893582526850288417749073264525576685000493847394, 
#     376373762241008816959329304056280026663829917234950779842813652374452622756608831351312306057877354585983767162747295724743960136392337308061836819612448849490458833878271739493534667487511823633542369549470371675270095486853197181172354538084297890418165559627737, 
#     168965967593648279496309157181569386454248631285818230208447588659397890002737303235660003041047275438595448934598212159197542312685172099211309217718235430779319698090851549187275394814284099275432295501381263600257164201553883101870422199581167830178522094160840, 
#     43800959558622905794273202448043019058060920141771653803357928127575661768296427638616034595462459369438716584076715322834383212288825111325513244741561960460911407188206322460292910131082026868193665264082098994968850274892203874054879270737673363075663184929556, 
#     37964868157359824415786063209271955456673881044584820100525146417071572608163159223211434062581386651834580910612124269886717314979396254337410696355522685042783018584557092002984363982154711157171643430689051712359438923831387490069158816837811013830811541440220, 
#     107969266230199346702307792945824627014689720218173814219803996883913380199399445504437463147203504835373178789410052062557602910323361231219195320352780965222827519483369305517938095657805402567072125170762765139179930756279035664278288913728429076540838501888861, 
#     306596617668158024690840309490135421804060394578379691970172847122236792002479037633782092942099151937485734654099654092428776320933801805747794468779040315541059445651110529410311492044837043996867087356865899914977169077908539134490215664049127868435773879606324, 
#     473376152343059236686451033998906425990939741587022320007455696938464660433855431400907909775886603000417733376803545853801383957430652077659692045849343522317069067611781473772965737282516761488831045122646974337096991637454560156805012372641309724397568327069473, 
#     273081665944311934438426924141513169893143808267086911930397341251543195201414754820681864985470211305875367120499964072990201499331821450121619816837608633698395285712997785686273851744108425460112711693052810929998313649232249652979732702210586255081228803161193, 
#     361879783526774984700481595321627321557471692939953596765492868838865460467929390706721096278952772196402792544689357500932930630155562479037356831675082418573586074285115649539780446786264356198895073735978127292074055834554013629520645273534783469129396998318772, 
#     226904722432024780663008650533959598256584365146101521492812437142984888698559618838191367375006406783045434184541500807625697725537504883691403218329281671891760322419729438849490286447953283655308611368072043689933038509669353002072158158304356733765227108357723, 
#     175551667918641034589745614243082169454525371380392477629036260308247813811977616109507583542974373370483281744822100984900133370283922680680755423279879315974304084178424064881630900394764056497462757411316654890913399644730255805151848106647392545146621667369897, 
#     93762174708138823699591362794033521944156247995133576745817572485671357123150850842333550242354889191812419159958500500790145377622925711765811429343387067753200576642407645066671983934860919792761734548138193822910129726427864214455135240991486522227823109070090, 
#     118511764541240786770297750835398325828089257959967790061221848551011453523136250637618714466025570532836009221704215644029167627774164265482985065651480265777659245359132805394195771963361712063656778993195598802276815166418997290943337478141049934087619421821276, 
#     325962651997651620606017749568503033818260135526488071937234405407383129285705342045898804025818952620414759162824181952762178621314138055129627993332936368622499617434629391808628588822263165954678076315946231472756025978132490329937492666699322727365067455847834, 
#     365479338963288498733204781966350293526408172014153855912184797518174488237129242901351382343481871850846833836681708014688450570888674832054893275254741141145694000690970294097321678340006712423320770720985920729734348714308609941519778073647218178991740867433758, 
#     441845951041238879631785199126334682089122392612117370191936506181354374915938142942138615808412655357223638272339470468243880815529617134334225616328950123058137302251093613177067688191785756657257697434874023634711296148483304780421583340373440307037386820108465, 
#     469678971777016475788645687341432008253376847730341486180978074394154205388742758783539475950312933458431726116843079200030194377232637371213523786770859999104332336265982594212160972777294878162157401144189967547692304002463338056164285914038338701114708494838861, 
#     308924612639622293147955145433325151998031824904408692124191354028254628305613130208555866159599192744870381773496968440357220347504149758498192340777195669999349194323829846657067370234703807174543487831097667817270570967352412465270600453462879058174871640750984, 
#     473721569852639617993851792628788774441137851934664996300288032108626886775900613835572982087795306281272185935539274174150720964564773447622503380414204732339330331669806560965548407563408927311487502550758553894558128373502456739245104068942646212249947623826720, 
#     273648106009189351326841405698138547737638033550197346938571281238425994270186706773773329292374065740076709716934593696388004693398634721450689379368317323833030745381608804765889675876953973072437271678247758201234844992433950261746154450223151347855473152423029, 
#     113981640142270222710041841164146519613356139357875335005068348380264101171794624213837082175578119876457323373074181194451958123505629411296105791727423719853524635807926075030771106072808395726290872544001212505459024688894275355143080215391526514056452646599054, 
#     443923349089156267626636088852744131632501002676954895982591040105760615466024854567128667531388851328032883942552044987099488430717423239973392590167238393538777456386861855971958436625025088303808531008974889621066985594104045432217679746745454844150330629365484, 
#     248788561853264183293814074958341442703249901647849087143895564716692444750204868795903641590134832287006482522776995344885521451390871781088061512728191309795574683333721000742954210722107290509457178382549030778941094986097357488787112981628214276859556450983306, 
#     135523348347187974661291479836589185905353487472827845480279653008608155895951195705971720477687079687461124258612912115068750356865937043228243987503947981062224951680092063983532215294105203601034149940548042989831378329837357420296793423218907054140627844035444, 
#     98373479430614263865710098106576267579642449348780112735212998812988391151552639528182772060343006889094208879491377872818229588403941592147990496834607249186839619893273497019085384046526040209348021118397285311192529022361360594473260913814785901948297192727122
# ]

from sage.modules.free_module_integer import IntegerLattice

# From https://oddcoder.com/LOL-34c3/, https://hackmd.io/@hakatashi/B1OM7HFVI
def Babai_CVP(mat, target):
    M = IntegerLattice(mat, lll_reduce=True).reduced_basis
    G = M.gram_schmidt()[0]
    diff = target
    for i in reversed(range(G.nrows())):
        diff -=  M[i] * ((diff * G[i]) / (G[i] * G[i])).round()
    return target - diff

# MOD = n
# for ppow in factors_p:
#     MOD *= ppow
# for ppow in factors_q:
#     MOD *= ppow

# mat = [
#     [1] + [v for v in coefs]
# ]
# for i in range(63):
#     arr = [0] + [0] * i + [MOD] + [0] * (62 - i)
#     mat.append(arr)

# mat = Matrix(mat)
# target = [n * 128 * 16] * 64
# target = vector(target)
# sum_m_a = Babai_CVP(mat, target)

# print(sum_m_a)

c = (
    1124116577345839308349399057374290997118297964793298589786643827170792123801300986205307046321709916355755317438087248744922501627435536948414295529143517347565274567106981557091378981683003933364354332700060450425140409738096777660080, 
    1413323290676030024726780231211485891888862749730435325415907184449651355371400245778160214088962781035963376582135684957006959721900197004177601882683252902055234096275236764454498875154374121373488146827145135788127771545708426373400, 
    1001978919348503569256150492771509050754389684643971242037252850840191631342308110799929181412725162983879942484657281770459325785959311872782020369979490449423017505679261366379710482426121937828197961928472087455125998875345037031432, 
    880003729461291877896903512796585269158282672638825014272358409672621329706085621304506108758239080590048992420007465603338601875359712442851326810177587545487921957457918741379429787181811772826994435990722432160325426277463947916512, 
    1178367176011666606761709552902192809981229025216717321355972887180833423015013217231310128168999115677512365881447569621608551974672499807858572969921076382500689769105594001177274943138899417232872255693242015876916332743702939688480, 
    1027931621466920836784215862222686014479826399552293499348235500502337417242375952741894174386192711581600663444550264247588590590776728220659397182257599655994478190562747000118602555961282715149251150649296739419337834778385137971518, 
    1205517687008920147197780338909842309605014695902069127156099397311624678528248373693886422542032101817108287243728845674543895357879385579888329259872791183641378636735990105512716508629026349470579673592520172750559347433768484538872, 
    989659860507400006569004560175001509155059772478139702179734240783989031519328774419268850269209631441748734248554663806855636310457847884179007286791470743685912050799921618609785816535306727561659444335804485911130431824341105716314, 
    1104086317298778410943107336500304181262831593763637695592271469010224460676894526626440130759564413789294256191028368799530107841439881100051939421783923877456880915582743766419535399600577794402703949847516784164537339197770748217090, 
    1058581359047352164749263709281385591200650028502387452839107422621910995137732754032175736901928144683042935139214668731257921338696031742638165512782029475533383881593751104921143978358632499415749566498533956528386238948997907797772, 
    1030721503724314369937983546538443629760879475429937528957533665894011238143084193032267281367869812416282882341365625590619808327401995710453215593706738154663621393417391114836769832988187862963869738616640130450849573913605619498770, 
    837907333276659057783404061761685621856581877344859249569484244398053121456346298027319855634228698625752247696917618553299365445946821199947993334175617219558249249538614010855141154111419613397312429082674423245041781494824474791980, 
    1302847534238420425862171383315577284374904429850801948519716824398747376865501004902385815636402887950579324645164535842046366024094387711316030542118982291114355490168180166315118036237737148121091676227187630916012230715882594368900, 
    851087961936565168125891750356299648032741463761976784226288496743643448038089009353663282518924575908613931307592729369560372801723119280395758917401352885622263445781668105631664427500640184826485781333637633331328806018791844057062, 
    1321954519641010106454502892920957483771196127961127972441775024547436939653647932944864724231987859006609757333787220373473063877760358839657805179817649008443672049243658157741873496149503776063206712379114888084222318242902878268210, 
    788182285379815289668813706764952899287549316191550482832885956483764415058376804455927434743657757999617645655173455326021259814645652959575024845254133280004255389861428479609138352970283499986275839883258156238267697645737644430382, 
    1171667484179257978349263606819577419989093184820956124254949841109468366679521773279573150462207436317131993618022291283633459818515061927419183243117112661850247506406575883307433450972548482242933286045606137862425275300312931322552, 
    1233081072867357308666995775548479058425465589268757838295390486236342835268021987707234216582534197435934618183984036461276010912513373086106587134716840469415602539248033438607655812805723447278783167916123741634594915539917739733454, 
    1205448187847418830073581566827650281288771424552726702816856761832509920404830528843770543799851229205882295208080811782711028597633026544692979547074947325355853329864241130121211509296493216429249093192464610902864042158374325980836, 
    982972765259279155756640767386637482274819791611369965479701098304127863529666086903883640479174711689025853952309469947487408596557127246505740736717943527846269903470499088580830344906075016634363516083611764788421280674996908803874, 
    1352629640430704854673488004334672021182988920760360491029335921141144806775125617940660893668864418475405954058027353904650281934428635827487155223791251046230591872234088126655832285156810098004318281746870304251866337043436650723356, 
    1201050740314964994949497214288446742847876507660164893106618920819230295110315695483988606623631315030477921535614569907497030288375392448556220785550301899235655391557545717229257116649637001726763223805814492297275553882823260058350, 
    1473422069658509840211818199940231981439009637360374977345445014499174090864816917947096044120143551972113934969646202257683059896866253945523948464228987493259524995286636567793695324242296567264405295061391653527707409789849318646302, 
    1162430900696220815316185148184024708978779275627876759398114585034097557576979951256244397029741674433629568332667582920530851887606669708865626434735604929151449188043854187834928065335634058904107381185097338147177562991197685073276, 
    1211309946978692878840176327107268458590634644039692696086523514504818986281298143559601743719005704339584999005844413405963499204086732638004159655003031156371532325165788644709324128818887821856221646872419082664441027209612935195464, 
    1251110270784220449687024780978264808891341598740311882602559284046425275812660967091962441065149141230809652876629093602546555997410158258346483543901587300006619788864060082528545110901693974414738975490776607335883652521858020538470, 
    1300837031232532601026640177767633157869065050774851074761290328766616110644957579153521718744923307937612083003709195991828350747655511627718019212491271942531484284698055410035161336296661880891237295537245839526135701241722863746312, 
    1375880865259748169533988326718041050101215560801115064375353909246831530088250223878151491376307488909624737942431094943957900013601592361516700950779529758207857814099629030213435474883277971780555650217137169827650323108652523231266, 
    1219929428349069092095034700752494872908849056880299484375039899903136412925084608739255088297700820610923237669267560072232139694121516568397145136777586988769175605401085865958828014422762695503846994118329910473365475301191332729772, 
    1457480237901306145840807841229744033361742222051880606916782060691255846457452864124579476792789922501477023776895485724101171224580962525684231386053137961981002931942543859750500460406576295939296130785494671679544793421980847199568, 
    1265093836146925345781785442620735367685299588062227186802836550153597129629985579279147327122715873489200242276502476846919459356833136214082176393247704030330580919635421902630740565963279228631347485141580799789514253420677575566308, 
    1117983720021130139267002959240934940574720258639157076926378262253310961592710072877195508936412358282161992478451332876403669755734498006820155340360898513900230618425880514821516427709761441224066602632886123760137888464971629714448, 
    1371263903371627016079454867679647968114995998139650309553187314328542653098773234981159062189306792227157447271090577801826143292272240049790776355948857190046466587830219016073308814841187678632984239834309909904203934132712356252744, 
    912694446589262469574475446976199565517186803398073064090230118034290554607963761157866873758091766690894265045726052358277520826170036279186141861652497214436565800769895280108640243119784982771602237832550671293243588234351690191520, 
    1270200017335700432165579750397797277892203336660871221702670435167210487732579903156202750970971138964171952399249001047929812113662521086858213523744599880237112210694118443415599268835815947792608522156473363148380323731179401255906, 
    1306961749933275570624817818745967020765428757301125279015032163997054963158058751662105407830762028475654692102092992221076498518406866789218063652117367834563187769590076491354609962946254800304032891407841793172388797204731821502390, 
    1143007666755389882744163073496919792856057865405537903841230049322313752508890317901732268627895777978970378386766237221907376195090545736543895392251642584774865592212451113734905414687147974457662201425714851259708484629543479118828, 
    1308206761741736968367962828722392894977331895261900469466765724309522491871798877346911395664983472620672401889370931950980829306642971307468757408579980789532417324967007013650773735396883725576034065995746647398690113174133752013652, 
    1419968380772332240829415081859032808744749554442889805017106142542262570459007863830711066877372149967507085498352430808843422429823800366315188447032229953643231903175569546404090692523567088397464249793857690533681381476567635947986, 
    1065035449627639415357065092814574527405029236924493036915908233187166794050302088743340453493092091755315651811873378900205487387691940500178313671064051447214484424205371007249219154062095243204795159672410290088533804282202746272234, 
    1266098135699094093525226885203705245425621794453106859988482332526849459301982445797953040638572409281651214124068833933329992187284792303017873588634116650958081152818571334796294323427305352833188750282719626333575333190628848791006, 
    1012015545934795245916735742626237846373811354886034101786458236481916218544033215384449702161160980014234409632264976027711741297577535342555733380102644187618515226190672788551780574195482537174830709306344282032210839370212887446810, 
    1579914389134233372596606337490489805257952023458867812828260972411310581771478161729945087223598626540939782169007286940993768136302333618190284884000687902567639401609286329750927526413139890023241846814864664062906330713169444296240, 
    1189731997720812322590721287757252742885396181237401835324472028790707633920605263258489717324068510636423088593886325344547479787813023874364686760275364479645589581714033155524490944906880858027394964068605653381797804840824133401724, 
    1060784570654312155689691418676243875684177844998549905682205663676998335512306120051982972604546896060147984876844241726605463063089048021070549696200834147428373705832281276975291068127074597254172722562275819146942324504857768334700, 
    1263305868372393103772338219407285199801167500170999649430141541553626794532356706604905763134490830354061798417603027595534243841224757316476792421361412316677413603006995588844717012603585234988886195778099285107552132907179568798072, 
    1270296795498367014460123156066389114767835594065285186977418709529932579797759599888952137080948972810658659662156450553797059925908589706903494639885468572323347154598871119031935319022911607095652368703560417275730595464977095200962, 
    1139842419606163217885270265700545838848295445851478213731500930688221395150900354054468075470839112241667274013821530751880931386181418943498047854037175053111432814221283725380327903244051059471917844427772744676747241527934424828888, 
    1326377733969765341479388539548542228382591801216228950914033374599159800726219026100699929184998561557972336390861337195027421437453871957324128375946856350394221757045861294934817669548559113201084500985369197792534097122552973825552, 
    1162362286867829614418074040630982793107362317714917072898994555959703064007018981106208654008753546504845135435658284292562781993076703141508802770139802978749131889911291556633646308834101944489784551263503180050091714833347350537424, 
    1187255645495532457070698120070339352302913635723719274601988624516299951898987531962891317825610976008670272653157694905179116239613535087332659098910383295491557752978696190125809062741080893455325025695883145247605089874674225055076, 
    1289206428868294702607876825068949505818370685676725374312893731529705731287600375083232761811829074577804410641106407933847015172560197430326532335849941777833908944913832539419331481206935929318840863870975296519006822943337356750266, 
    1083120600803788268032650914717078473498562602987543792625547697158762660350412834751900571534024201653862255377524646795796110242934567432055758318236629791312588413213859014857494821603229063820366580307901128883600235654678989741068, 
    1023295976438409946962074847978941531498153475103651277483810090772720833337762317856295149725193381630353412985773040353554701083791874289526606861894910237706047861862614705989746945852364003260842437110020499309375919259503503881370, 
    1168736855818733456295932211979355434944904376061226486225916952257092009865112717630958848289516110310202475658458980062498654991768727213864902718101165664218399940690526806666222417447947603737050234430257402035134914591399305274940, 
    1327557663202158305628163943235460597431590898042968038390201412999680965090431821359669940123460057242570000875579375293575329885754643202346040450577421985101806163412368725116692836926466749411732802293123849149884275180033305754552, 
    1291154939206841804344165451405962073688494946441872479742702797032839850138185293197440887330961369946757483579105048589768838603717945608896100296452988973586108395928386903503723488070772865812163889694954956304207224295383660605256, 
    1095320197029913612427966547904584509116797782252299817456312168428193219643698923869163302873119878496584945714339593391552048588374678057106683700861860322649587086326855094312780503939645698583468994389710747046161432200400738092016, 
    1456742372193247585791407274968232555708898860544517065838251304091936962320954475760942046673312729258881917952735764610913022864167399639716540306315262725004203038306144733975931882455445919074153269856747457555482834049534062580040, 
    1000919356915645576845150644258538320386455124911967036718810024779856564373682752976838825582518061601338412718837906371683393518468448333486981824555282963824938531663307174485344323009566786469209289882726569203950703318043193001068, 
    1387117868210508977407714973097203004213173269812422488254332649338156192166594128813901877597194931785544179418271089562885086682636444914803426452972335549569300083348124053600424441956651287219194370142853846925304065343689019631422, 
    1305774873856572846283203062611369437833018279611083952647597026528953533990976216185925993529385009795024288287782067755676225041187860178793044173246445472106865732033391460643082743053319403309407649116758178890371257293758363441162, 
    1300202125352255190572295537850960159701803030723009615134392552893407895019087842456428795544000514911510605969778727547433014510949342729310769745908582823585646059781310916773903294830628146082069018962179380837947622911300124531586, 
    1118027631313233289813397370676852323954707076485863449504023236376043020954019910135143206224123104403253282928903163513545469581693010593989660870678055079504844575978279306921181830625036966401537886260081596797608391357611602461872
)

# sub = list(range(64))
# recovered = set([
#     (66, 235, 40, 8, 120, 2, 125, 115, 80, 184, 229, 180, 217, 41, 31, 77, 214, 130, 210, 47, 243, 216, 227, 238, 160, 192, 179, 124, 187, 183, 57, 138, 8, 83, 23, 40, 182, 196, 180, 152, 64, 210, 168, 192, 189, 203, 74, 66, 223, 81, 245, 170, 19, 162, 145, 237, 93, 49, 94, 136, 32, 233, 246, 96),
#     (183, 64, 71, 75, 215, 50, 244, 193, 68, 75, 70, 183, 68, 116, 210, 138, 147, 174, 215, 152, 191, 92, 93, 71, 155, 239, 119, 80, 122, 254, 238, 216, 64, 9, 171, 252, 35, 200, 169, 154, 145, 80, 201, 51, 12, 40, 113, 27, 182, 188, 36, 1, 114, 112, 143, 172, 179, 207, 201, 177, 206, 103, 155, 85),
#     (78, 207, 251, 51, 197, 6, 171, 185, 177, 62, 110, 0, 144, 3, 83, 11, 239, 127, 28, 111, 124, 111, 230, 91, 162, 161, 97, 171, 0, 234, 86, 123, 189, 16, 164, 162, 6, 179, 249, 46, 190, 134, 228, 160, 168, 168, 210, 79, 210, 148, 175, 247, 171, 199, 142, 247, 233, 93, 255, 18, 208, 169, 136, 126),
#     (102, 121, 100, 129, 176, 96, 137, 158, 84, 33, 45, 14, 155, 107, 241, 176, 102, 29, 162, 211, 129, 146, 218, 213, 134, 144, 125, 84, 253, 195, 136, 174, 132, 132, 228, 140, 236, 149, 10, 77, 219, 225, 179, 184, 226, 199, 140, 178, 1, 17, 8, 228, 241, 27, 250, 0, 81, 90, 243, 147, 147, 146, 116, 49),
#     (70, 78, 111, 167, 230, 251, 108, 78, 79, 125, 38, 226, 230, 86, 211, 103, 12, 207, 225, 79, 137, 123, 232, 113, 133, 43, 66, 20, 146, 162, 96, 14, 54, 187, 171, 133, 118, 98, 206, 6, 160, 84, 118, 164, 210, 57, 193, 139, 79, 40, 135, 9, 186, 109, 53, 81, 83, 150, 195, 167, 97, 249, 135, 56),
#     (113, 154, 4, 53, 128, 141, 208, 70, 155, 59, 34, 107, 75, 123, 30, 135, 90, 237, 137, 29, 222, 223, 42, 218, 196, 226, 7, 141, 183, 238, 162, 183, 175, 228, 31, 239, 184, 225, 90, 139, 76, 244, 82, 80, 162, 126, 5, 12, 77, 149, 239, 193, 22, 201, 50, 87, 171, 196, 215, 33, 39, 66, 250, 192),
#     (194, 164, 16, 31, 13, 221, 219, 72, 98, 223, 170, 59, 40, 133, 35, 32, 33, 147, 22, 68, 89, 74, 219, 39, 167, 97, 152, 235, 57, 79, 132, 227, 132, 108, 42, 88, 69, 15, 115, 202, 146, 72, 224, 34, 57, 5, 125, 201, 140, 176, 200, 154, 119, 19, 77, 22, 196, 55, 166, 2, 191, 180, 97, 207),
#     (67, 214, 134, 138, 167, 98, 84, 58, 113, 252, 116, 168, 76, 221, 234, 225, 174, 80, 60, 15, 129, 222, 234, 78, 88, 51, 126, 2, 38, 77, 80, 46, 171, 32, 39, 179, 211, 220, 246, 65, 253, 138, 189, 82, 191, 243, 171, 154, 244, 252, 158, 47, 154, 244, 168, 219, 85, 232, 198, 136, 56, 126, 43, 205),
#     (145, 133, 72, 127, 18, 172, 54, 27, 32, 20, 23, 169, 227, 24, 136, 128, 31, 186, 109, 54, 243, 156, 118, 25, 45, 22, 88, 226, 223, 202, 160, 161, 255, 99, 234, 145, 157, 208, 140, 66, 230, 23, 182, 127, 26, 108, 5, 12, 172, 12, 161, 252, 67, 123, 112, 122, 114, 78, 96, 71, 253, 174, 217, 240),
#     (204, 94, 121, 51, 205, 67, 75, 71, 182, 64, 21, 9, 204, 33, 253, 61, 101, 150, 143, 230, 139, 234, 181, 185, 31, 46, 245, 220, 252, 90, 170, 5, 234, 150, 133, 16, 177, 50, 67, 172, 181, 24, 197, 61, 246, 213, 125, 158, 176, 156, 3, 152, 85, 12, 105, 185, 88, 133, 142, 228, 101, 51, 84, 110),
#     (220, 212, 182, 34, 93, 17, 90, 167, 135, 41, 15, 10, 51, 253, 212, 238, 246, 170, 123, 108, 35, 105, 195, 2, 208, 227, 200, 252, 58, 136, 191, 50, 222, 7, 104, 5, 90, 50, 202, 158, 231, 117, 110, 242, 179, 29, 195, 17, 103, 66, 22, 205, 201, 225, 73, 156, 213, 51, 141, 176, 219, 190, 151, 101),
#     (94, 195, 213, 2, 50, 240, 253, 51, 100, 194, 169, 84, 233, 191, 223, 14, 127, 26, 57, 106, 156, 133, 202, 176, 78, 255, 158, 194, 105, 248, 221, 138, 91, 70, 46, 188, 14, 108, 211, 138, 127, 230, 171, 190, 4, 36, 232, 90, 96, 114, 122, 74, 239, 64, 208, 145, 39, 188, 76, 233, 220, 7, 60, 174),
#     (131, 254, 187, 142, 40, 93, 209, 136, 150, 89, 2, 25, 246, 44, 206, 93, 140, 114, 191, 121, 144, 154, 83, 205, 91, 205, 142, 251, 127, 20, 13, 5, 96, 193, 110, 197, 148, 221, 17, 252, 28, 221, 217, 100, 199, 214, 116, 242, 20, 186, 226, 83, 72, 134, 229, 248, 62, 229, 57, 189, 154, 157, 30, 246),
#     (3, 140, 26, 202, 70, 244, 17, 137, 20, 12, 228, 122, 14, 152, 211, 94, 162, 145, 240, 207, 101, 161, 4, 250, 221, 140, 133, 144, 209, 101, 51, 180, 141, 230, 238, 243, 237, 153, 68, 2, 122, 170, 171, 207, 46, 206, 114, 238, 200, 154, 28, 93, 12, 47, 178, 9, 145, 206, 115, 33, 200, 21, 114, 52),
#     (145, 109, 179, 225, 188, 32, 26, 74, 229, 222, 208, 16, 163, 129, 112, 11, 91, 2, 224, 74, 213, 14, 243, 165, 181, 65, 185, 24, 206, 177, 197, 7, 187, 68, 208, 214, 121, 78, 217, 175, 41, 14, 114, 248, 40, 196, 242, 208, 48, 96, 171, 181, 254, 153, 138, 187, 98, 59, 133, 87, 91, 218, 254, 11)
# ])

# cnt = 32

# while len(recovered) < 16:
#     random.shuffle(sub)
#     rev = [None for _ in range(64)]
#     for i in range(64):
#         rev[sub[i]] = i

#     C = Matrix([[c[sub[i]]] for i in range(64)])

#     A = []
#     A.append([c[sub[i]] for i in range(64)])
#     # for row in recovered:
#     #     A.append(list(row))
#     for i in range(64):
#         A.append([0] * i + [1] + [0] * (63 - i))
#     A = Matrix(A)
#     A = A.transpose().LLL()

#     for i in range(64 - 16):
#         assert A[i,0] == 0
    
    

#     Mk = A[0:64 - 16,1:]

#     # print(Mk)
#     yolo = Mk.right_kernel_matrix() #.LLL()

#     # base = random.randint(64, 192)

#     res = Babai_CVP(yolo, vector([random.randint(0, 255) for _ in range(64)]))
#     row = tuple(res[rev[i]] for i in range(64))

#     if row not in recovered:
#         print(row)
#         recovered.add(row)
#     else:
#         cnt = min(128, cnt + 1)

#     print(len(recovered))

# From braindead
# Y = fpylll.IntegerMatrix(64, 16)
# for i in range(rows):
#     for j in range(cols):
#         Y[i,j] = yolo[i,j]

# Y.transpose()

# sice_set = set()
# while True:
#     target = [randrange(256) for _ in range(64)]
#     v = fpylll.CVP.closest_vector(Y, target)

res = [
    (70, 78, 111, 167, 230, 251, 108, 78, 79, 125, 38, 226, 230, 86, 211, 103, 12, 207, 225, 79, 137, 123, 232, 113, 133, 43, 66, 20, 146, 162, 96, 14, 54, 187, 171, 133, 118, 98, 206, 6, 160, 84, 118, 164, 210, 57, 193, 139, 79, 40, 135, 9, 186, 109, 53, 81, 83, 150, 195, 167, 97, 249, 135, 56),
    (78, 207, 251, 51, 197, 6, 171, 185, 177, 62, 110, 0, 144, 3, 83, 11, 239, 127, 28, 111, 124, 111, 230, 91, 162, 161, 97, 171, 0, 234, 86, 123, 189, 16, 164, 162, 6, 179, 249, 46, 190, 134, 228, 160, 168, 168, 210, 79, 210, 148, 175, 247, 171, 199, 142, 247, 233, 93, 255, 18, 208, 169, 136, 126),
    (194, 164, 16, 31, 13, 221, 219, 72, 98, 223, 170, 59, 40, 133, 35, 32, 33, 147, 22, 68, 89, 74, 219, 39, 167, 97, 152, 235, 57, 79, 132, 227, 132, 108, 42, 88, 69, 15, 115, 202, 146, 72, 224, 34, 57, 5, 125, 201, 140, 176, 200, 154, 119, 19, 77, 22, 196, 55, 166, 2, 191, 180, 97, 207),
    (66, 235, 40, 8, 120, 2, 125, 115, 80, 184, 229, 180, 217, 41, 31, 77, 214, 130, 210, 47, 243, 216, 227, 238, 160, 192, 179, 124, 187, 183, 57, 138, 8, 83, 23, 40, 182, 196, 180, 152, 64, 210, 168, 192, 189, 203, 74, 66, 223, 81, 245, 170, 19, 162, 145, 237, 93, 49, 94, 136, 32, 233, 246, 96),
    (102, 121, 100, 129, 176, 96, 137, 158, 84, 33, 45, 14, 155, 107, 241, 176, 102, 29, 162, 211, 129, 146, 218, 213, 134, 144, 125, 84, 253, 195, 136, 174, 132, 132, 228, 140, 236, 149, 10, 77, 219, 225, 179, 184, 226, 199, 140, 178, 1, 17, 8, 228, 241, 27, 250, 0, 81, 90, 243, 147, 147, 146, 116, 49),
    (94, 195, 213, 2, 50, 240, 253, 51, 100, 194, 169, 84, 233, 191, 223, 14, 127, 26, 57, 106, 156, 133, 202, 176, 78, 255, 158, 194, 105, 248, 221, 138, 91, 70, 46, 188, 14, 108, 211, 138, 127, 230, 171, 190, 4, 36, 232, 90, 96, 114, 122, 74, 239, 64, 208, 145, 39, 188, 76, 233, 220, 7, 60, 174),
    (204, 94, 121, 51, 205, 67, 75, 71, 182, 64, 21, 9, 204, 33, 253, 61, 101, 150, 143, 230, 139, 234, 181, 185, 31, 46, 245, 220, 252, 90, 170, 5, 234, 150, 133, 16, 177, 50, 67, 172, 181, 24, 197, 61, 246, 213, 125, 158, 176, 156, 3, 152, 85, 12, 105, 185, 88, 133, 142, 228, 101, 51, 84, 110),
    (3, 140, 26, 202, 70, 244, 17, 137, 20, 12, 228, 122, 14, 152, 211, 94, 162, 145, 240, 207, 101, 161, 4, 250, 221, 140, 133, 144, 209, 101, 51, 180, 141, 230, 238, 243, 237, 153, 68, 2, 122, 170, 171, 207, 46, 206, 114, 238, 200, 154, 28, 93, 12, 47, 178, 9, 145, 206, 115, 33, 200, 21, 114, 52),
    (183, 64, 71, 75, 215, 50, 244, 193, 68, 75, 70, 183, 68, 116, 210, 138, 147, 174, 215, 152, 191, 92, 93, 71, 155, 239, 119, 80, 122, 254, 238, 216, 64, 9, 171, 252, 35, 200, 169, 154, 145, 80, 201, 51, 12, 40, 113, 27, 182, 188, 36, 1, 114, 112, 143, 172, 179, 207, 201, 177, 206, 103, 155, 85),
    (145, 133, 72, 127, 18, 172, 54, 27, 32, 20, 23, 169, 227, 24, 136, 128, 31, 186, 109, 54, 243, 156, 118, 25, 45, 22, 88, 226, 223, 202, 160, 161, 255, 99, 234, 145, 157, 208, 140, 66, 230, 23, 182, 127, 26, 108, 5, 12, 172, 12, 161, 252, 67, 123, 112, 122, 114, 78, 96, 71, 253, 174, 217, 240),
    (113, 154, 4, 53, 128, 141, 208, 70, 155, 59, 34, 107, 75, 123, 30, 135, 90, 237, 137, 29, 222, 223, 42, 218, 196, 226, 7, 141, 183, 238, 162, 183, 175, 228, 31, 239, 184, 225, 90, 139, 76, 244, 82, 80, 162, 126, 5, 12, 77, 149, 239, 193, 22, 201, 50, 87, 171, 196, 215, 33, 39, 66, 250, 192),
    (131, 254, 187, 142, 40, 93, 209, 136, 150, 89, 2, 25, 246, 44, 206, 93, 140, 114, 191, 121, 144, 154, 83, 205, 91, 205, 142, 251, 127, 20, 13, 5, 96, 193, 110, 197, 148, 221, 17, 252, 28, 221, 217, 100, 199, 214, 116, 242, 20, 186, 226, 83, 72, 134, 229, 248, 62, 229, 57, 189, 154, 157, 30, 246),
    (220, 212, 182, 34, 93, 17, 90, 167, 135, 41, 15, 10, 51, 253, 212, 238, 246, 170, 123, 108, 35, 105, 195, 2, 208, 227, 200, 252, 58, 136, 191, 50, 222, 7, 104, 5, 90, 50, 202, 158, 231, 117, 110, 242, 179, 29, 195, 17, 103, 66, 22, 205, 201, 225, 73, 156, 213, 51, 141, 176, 219, 190, 151, 101),
    (67, 214, 134, 138, 167, 98, 84, 58, 113, 252, 116, 168, 76, 221, 234, 225, 174, 80, 60, 15, 129, 222, 234, 78, 88, 51, 126, 2, 38, 77, 80, 46, 171, 32, 39, 179, 211, 220, 246, 65, 253, 138, 189, 82, 191, 243, 171, 154, 244, 252, 158, 47, 154, 244, 168, 219, 85, 232, 198, 136, 56, 126, 43, 205),
    (145, 109, 179, 225, 188, 32, 26, 74, 229, 222, 208, 16, 163, 129, 112, 11, 91, 2, 224, 74, 213, 14, 243, 165, 181, 65, 185, 24, 206, 177, 197, 7, 187, 68, 208, 214, 121, 78, 217, 175, 41, 14, 114, 248, 40, 196, 242, 208, 48, 96, 171, 181, 254, 153, 138, 187, 98, 59, 133, 87, 91, 218, 254, 11),
    (86, 145, 1, 192, 164, 222, 106, 85, 201, 237, 152, 229, 234, 13, 52, 132, 72, 250, 32, 27, 25, 36, 31, 42, 28, 150, 177, 100, 26, 113, 219, 203, 177, 134, 213, 39, 250, 250, 232, 4, 17, 12, 56, 3, 112, 198, 155, 183, 106, 93, 141, 37, 18, 25, 0, 82, 233, 5, 250, 116, 46, 235, 126, 18)
]

from Crypto.Cipher import AES
from hashlib import sha256

mat = Matrix(res)
ans = mat.solve_left(vector(c))
ans = int(sum(ans))

E = EllipticCurve(Zmod(n^2), [a, b])

MOD = gift * n
P = E(chimera[0][0], chimera[0][1])
assert (MOD + 1) * P == P

for i in range(64):
    g = int(gcd(c[i], ans))
    if gcd(c[i] // g, MOD) != 1:
        continue

    P = E(chimera[i][0], chimera[i][1])
    res = int(1 / Zmod(MOD)(c[i] // g))
    wow = res * P

    assert (c[i] // g) * wow == P
    wow = (ans // g) * wow

    key = sha256(str(wow.xy()[0]).encode()).digest()[:16]
    cipher = AES.new(key, AES.MODE_CBC, b"\0" * 16)
    print(cipher.decrypt(flagct))
